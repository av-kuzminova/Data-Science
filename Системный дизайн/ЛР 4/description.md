# 1: Создание и настройка docker-compose.yml 
Файл docker-compose.yml описывает, как должны запускаться все сервисы проекта. Здесь настроено 3 контейнера: 

PostgreSQL (db) — хранит основные данные приложения, например, пользователей и товары. 
MongoDB (mongo) — используется для хранения другой сущности (Order), демонстрируя раздельное использование разных баз данных. 
FastAPI (app) — Python-приложение, которое запускает API-сервис и взаимодействует с обеими базами данных.

Ключевые моменты настройки docker-compose.yml: 
Переменные окружения для PostgreSQL: указываются POSTGRES_USER, POSTGRES_PASSWORD и POSTGRES_DB, необходимые для настройки доступа к базе данных. 
Переменные окружения для MongoDB: задаются MONGO_INITDB_ROOT_USERNAME и MONGO_INITDB_ROOT_PASSWORD, которые MongoDB использует для начальной настройки. 
Связи между сервисами: сервис app зависит от db и mongo (параметр depends_on), что гарантирует запуск баз данных перед запуском приложения. 
Общий доступ через сеть: app, db и mongo объединены в одну виртуальную сеть (app-network), чтобы сервисы могли "видеть" друг друга и обмениваться данными. 

# 2: Подготовка скрипта init_db.py для инициализации баз данных
init_db.py выполняет две основные задачи:
Создание таблиц и начальных данных в PostgreSQL. 
Инициализация MongoDB. 

# 3: Модели данных (models.py) для PostgreSQL и MongoDB
В этом проекте мы используем две разные технологии хранения данных, что требует различных моделей данных:

SQLAlchemy-модели для PostgreSQL: здесь определены модели User и Item, представляющие данные в формате реляционной базы. Указаны типы столбцов и созданы связи, такие как уникальность имени пользователя. 
Pydantic-модель для MongoDB: модель Order используется для описания сущности заказа, хранящейся в MongoDB. Pydantic обеспечивает проверку данных, а также совместимость с MongoDB, у которой другой формат хранения данных. Поле _id автоматически заполняется значением ObjectId, стандартным идентификатором MongoDB.

# 4: Обновление main.py для работы с MongoDB и PostgreSQL
main.py реализует API-сервис на FastAPI. В этом файле добавлена поддержка двух баз данных:

Подключение к PostgreSQL. Для PostgreSQL используется SQLAlchemy, и FastAPI использует подключение через SessionLocal для всех операций с пользователями и товарами.

Подключение к MongoDB. Для MongoDB подключение выполняется с помощью MongoClient, который создаёт объект mongo_db для работы с коллекциями.

Эндпоинты FastAPI:

Эндпоинты для работы с PostgreSQL (например, пользователи и товары) остаются прежними.
Эндпоинты для MongoDB: добавлены два новых эндпоинта — один для создания заказа и один для получения информации о заказе по order_number.
POST /orders — создаёт новый заказ в MongoDB. Этот эндпоинт сначала проверяет, существует ли уже заказ с таким номером (order_number). Если да, возвращается ошибка.
GET /orders/{order_number} — ищет заказ по order_number. Если заказ не найден, возвращается ошибка 404.

# 5: Запуск проекта
Чтобы запустить проект, нужно использовать команду:

bash
Копировать код
docker-compose up --build
Команда docker-compose up:

Собирает образы контейнеров на основе Dockerfile. 
Запускает контейнеры PostgreSQL и MongoDB с указанием нужных переменных окружения. 
Инициализирует базы данных. При первом запуске выполняется init_db.py, который создаёт таблицы PostgreSQL и индекс MongoDB. 
Открывает приложение на localhost:8000. FastAPI будет доступен по этому адресу, и вы сможете тестировать API через инструменты, такие как Postman, или напрямую из браузера. 

Обзор всей системы
В итоге, проект использует две базы данных для различных сущностей:

PostgreSQL хранит такие данные, как пользователи и товары.
MongoDB используется для хранения информации о заказах, для которых индексы ускоряют доступ и поддерживают уникальность.
